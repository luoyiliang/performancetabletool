Project name: Peformance table tool

Doc version: 1.0

Doc author: Roy.Luo

Doc date: 2024-07-20

---

# 1. 项目背景与目标

## 项目背景

Performance table tool是基于Python开发的，用于将特定XML文件转换为特定格式的Excel文件的工具。为了提升用户体验，该工具需要一个简洁直观，易于使用的图形用户界面。使用户轻松选择XML文件，配置生成选项并完成EXCEL文件的导出。

## 设计目标
设计一个用户友好的桌面UI界面，帮助用户：
- 轻松地选择并导入XML文件。
- 配置文件解析和Excel生成的相关选项。
- 根据用户需求生成并保存Excel文件。
- 提供明确的错误提示和状态反馈。

# 2. 用户需求分析

## 目标用户
- 对技术要求不高的办公人员或非技术背景用户。

## 用户场景

- 用户需要将一个或多个XML文件转换为Excel的.xlsx文件。
- 用户希望通过简单的操作快速完成文件的转换，并且不需要理解文件结构。
- 用户希望能有清晰的操作引导及错误提示，以便知道何时成功生成文件或发生错误。

# 3. 功能需求

## 3.1 基本功能
### 文件选择
- 能够通过“打开XML文件”对话框选择XML文件，支持单个文件选择。
- 在界面上显示已选择的XML文件路径。

### 输出路径选择
- 用户可以通过界面选择保存生成的Excel文件的路径。
- 默认保存到与XML文件相同的目录，并允许用户更改保存位置。

### 生成选项设置
- 提供信息来源设置，用户可以选择从XML文件的哪个节点获取数据。
- 提供Excel表格的列名设置，用户可以选择Excel表格的列名。

### 生成Excel的选项
- 提供一个“生成”按钮，点击后开始解析XML文件并生成Excel文件。
- 文件生成后，显示成功提示并提供打开文件的快捷方式。
### 状态反馈
- 在文件解析和生成过程中，显示进度条或状态信息。
解析失败时，显示错误提示，并提供详细的错误信息（如XML格式错误）。
### 日志功能
- 在界面中提供一个可选按钮或菜单，允许用户查看程序运行日志。

## 3.2 高级功能（可选）
###  批量处理
- 支持用户选择多个XML文件，并批量生成对应的Excel文件。
### 文件预览
在用户选择XML文件后，显示文件的部分内容或结构预览。
### 自定义Excel格式
用户可以通过界面配置Excel生成的格式（如列宽、字体、样式等）。

# 4. 用户交互设计
## 4.1 主要界面元素
### 4.1.1 主界面布局
- 顶部标题：显示应用名称 XML to Excel Tool，位于窗口顶部。
- 文件选择区：包含“选择XML文件”按钮和显示文件路径的文本框。
- 输出路径区：包含“选择保存路径”按钮和显示保存路径的文本框。
- 操作按钮区：
  - 生成Excel：点击后开始文件解析与Excel生成。
  - 退出：点击后退出程序。
- 状态显示区：
  - 用于显示当前的文件解析状态、操作成功或失败的提示。
  - 在生成过程中显示进度条。
### 4.1.2 交互流程
#### 流程1：选择XML文件并生成Excel

用户启动程序，看到主界面。
用户点击“选择XML文件”按钮，弹出文件选择对话框，选择一个XML文件。
选择文件后，文件路径会显示在文本框中。
用户点击“选择保存路径”按钮，弹出文件保存路径选择框。
用户点击“生成Excel”按钮，开始生成文件，状态栏显示当前操作状态。
生成成功后，弹出提示框告知用户文件生成成功并提供打开文件选项；若生成失败，显示错误提示。
## 4.2 交互细节
### 文件选择
- 支持拖放功能：用户可以将XML文件拖入文件选择区。
在用户选择文件后，若文件格式不正确（非XML文件），弹出错误提示。
生成操作
点击“生成Excel”按钮后，按钮变为不可点击状态，直至生成任务完成。
- 生成过程中，显示进度条和状态信息（如“正在解析XML文件...”）。
- 生成完成后，恢复按钮状态，并弹出成功或失败提示。
### 错误提示
- 若用户未选择XML文件或保存路径，点击“生成Excel”按钮时，给出提示。
- 若XML文件格式错误或文件无法访问，显示具体的错误信息。
日志查看
- 提供一个菜单或按钮，允许用户查看程序的运行日志，日志显示在弹出窗口中。

# 5. 设计风格指南
## 5.1 视觉风格
简洁、现代、专业：界面应保持简洁，避免复杂的设计元素，确保用户一目了然。
颜色：
- 主色调：蓝色（#007BFF），用于按钮和标题栏。
- 辅助色：浅灰色（#F5F5F5），用于背景和状态栏。
- 错误提示：红色（#DC3545），用于错误信息显示。
- 字体：使用系统默认字体(Segoe UI)
- 图标：使用常见的文件选择、保存、错误提示图标，确保用户能直观理解功能。

## 5.2 布局原则
层次分明：将主要操作（如文件选择、生成Excel）置于界面中心，确保用户操作流畅。
响应式设计：界面应根据窗口大小调整布局，确保在不同分辨率下都能正常显示。
对齐与间距：保证界面元素之间的间距一致，文本框、按钮等元素上下对齐，保持视觉上的整齐感。

## 5.3 可访问性
文本与背景的高对比度：确保界面中的文本清晰可读，特别是在不同亮度和对比度设置下。
键盘友好：所有按钮和输入框应支持键盘操作，用户可以通过Tab键在控件之间切换。
错误提示的可见性：错误提示应使用明显的颜色（如红色），并且提供简洁的描述。

# 6. 开发与设计约束
- 使用PyQt5 进行UI开发，选择的库应便于跨平台部署（Windows、macOS、Linux）。
- UI 应该支持最小化、最大化和窗口大小的调整。
- 界面加载速度应保持在1秒内，避免用户等待时间过长。
在高分辨率显示器上，界面元素应自动调整大小，确保显示效果一致。

# 7. 测试与验收标准
## 7.1 功能测试
文件选择功能是否正常工作，支持不同路径和文件类型。
文件解析与Excel生成功能是否按照预期执行。
错误提示信息是否准确，能够明确指示用户问题所在。
状态反馈（进度条、提示信息）是否及时显示并清晰易懂。

## 7.2 用户体验测试
界面是否简洁易用，用户是否能够在不阅读文档的情况下完成文件转换操作。
界面布局和操作流程是否符合用户习惯，是否有多余的操作步骤。
## 7.3 可访问性测试
界面是否支持键盘操作，是否为视力障碍者提供了足够的可见性支持（如高对比度模式）。
界面在不同分辨率和屏幕尺寸下是否正常显示。